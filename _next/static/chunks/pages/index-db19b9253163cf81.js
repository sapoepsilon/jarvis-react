(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(282)}])},282:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var r=n(5893),i=n(7294);let s=e=>{let{size:t,waveColor:n,value:i,children:s}=e;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:s}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center opacity-50",style:{transform:"scale(".concat(1+(0===i?0:t*i*.4)/t,")")},children:(0,r.jsx)("div",{className:"w-".concat(t," h-").concat(t," rounded-full border-2 pointer-events-none"),style:{borderColor:n}})})]})},l=e=>{let{voiceValue:t,isListening:n,onMouseDown:i,onMouseUp:l}=e,a=e=>{e.preventDefault(),i()},o=e=>{e.preventDefault(),l()};return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gray-100",children:(0,r.jsx)(s,{size:200,waveColor:"#4B5563",value:n?t:0,children:(0,r.jsx)("button",{className:"px-9 py-3 rounded-full focus:outline-none select-none ".concat(n?"bg-red-600":"hover:bg-blue-300 bg-gray-600"," "),onMouseDown:i,onMouseUp:l,onTouchStart:a,onTouchEnd:o,onTouchCancel:o,children:"\uD83C\uDFA4"})})})},a=e=>{let{onClick:t}=e;return(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 ml-3 rounded-lg bg-green-500 text-white focus:outline-none focus:ring-2 focus:ring-green-300",children:"Send"})};n(3547);let o=()=>{let[e,t]=(0,i.useState)(0);return(0,i.useEffect)(()=>(navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{let n=new AudioContext,r=n.createMediaStreamSource(e),i=n.createAnalyser();r.connect(i),i.fftSize=32;let s=i.frequencyBinCount,l=new Uint8Array(s),a=()=>{requestAnimationFrame(a),i.getByteFrequencyData(l);let e=l.reduce((e,t)=>e+t,0)/s;t(e/255*100)};a()}).catch(e=>{console.log(e)}),()=>{}),[]),e},c=e=>{let{children:t}=e,n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight)},[t]),(0,r.jsx)("div",{ref:n,className:"bg-jarvis-background  rounded-2xl backdrop-blur-lg sticky top-0 w-screen h-[70vh] overflow-y-scroll flex flex-col items-end p-4 opacity-80",children:t})},u=e=>{let{message:t}=e,{text:n,isMe:i,isInterim:s}=t;return(0,r.jsx)("div",{className:"w-full ".concat(i?"text-right":"text-left"),children:(0,r.jsx)("span",{className:"inline-block rounded-lg px-3 py-2 ".concat(i?"bg-user-message":s?"bg-slate-300":"bg-gpt-message"," ").concat(s?"text-black":"text-white"),children:n})})},d=e=>{let{messages:t,interimTranscript:n}=e;return(0,r.jsx)("div",{className:"flex flex-col space-y-3",children:t.map((e,t)=>(0,r.jsx)(u,{message:e},t))})};var g=n(8820),f=n.n(g);let p=async()=>new Promise(e=>{f().getPromise().then(t=>{console.log("components",t);let n=t.map(e=>e.value),r=f().x64hash128(n.join(""),31);e(r)}).catch(()=>{e("")})});n(6282);var m=n(4866);m.Z.initializeApp({experimentalForceLongPolling:!0,useFetchStreams:!1,apiKey:"AIzaSyBriWM_fmaOPbqSCzDPWe-MHCsQ8EKN7As",authDomain:"jarvis-rea.firebaseapp.com",projectId:"jarvis-rea",storageBucket:"jarvis-rea.appspot.com",messagingSenderId:"320890465335",appId:"1:320890465335:web:b5d64af2da377ec22d23b2",measurementId:"G-RCH1EHYB94"});let h=m.Z.firestore();var x=class{async addDateToFingerprint(e,t,n){t.toISOString().split("T")[0],console.log("from fingerprints");let r={fingerprint:e,date:t,values:n},i=r.fingerprint,s=h.collection("fingerprints").doc(i);await s.set({fingerprintValue:r},{merge:!0}).catch(e=>{console.error("Error adding document: ",e)}).then(()=>{console.log("Document successfully written!")})}async fetchFingerprintData(e){let t=h.collection("fingerprints").doc(e);try{let e=await t.get();if(!e.exists)return console.error("No fingerprint data found."),null;{let t=e.data();return t}}catch(e){return console.error("Error fetching fingerprint data:",e),null}}};let v=()=>{let[e,t]=(0,i.useState)(!1),[n,s]=(0,i.useState)(""),[u,g]=(0,i.useState)([]),[f,m]=(0,i.useState)(!0),h=(0,i.useRef)(null),v=o(),w=new x,[y,b]=(0,i.useState)(null),[j,N]=(0,i.useState)(!1),D=new Date;(0,i.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){if(h.current=new e,h.current){h.current.continuous=!1,h.current.interimResults=!0;let e="",n="";h.current.onresult=t=>{N(!0);for(let r=t.resultIndex;r<t.results.length;r++){let i=t.results[r][0].transcript;t.results[r].isFinal?(s(e+=i),e=""):(s(e+(n+=i)),console.log("trascript is set in is Final else"))}n=""},h.current.onend=()=>{console.log("recognition ended"),t(!1),s("")}}else alert("Error initializing")}else alert("SpeechRecognition is not supported in this browser. Please use Chrome or Safari."),console.error("SpeechRecognition is not supported in this browser."),m(!1);let n=async()=>{let e;p().then(async t=>{if(null!=(e=await w.fetchFingerprintData(t))||void 0!=e){let t={fingerprintValue:e.fingerprintValue};b(t)}})};return n(),()=>{h.current&&h.current.stop()}},[]);let S=()=>{N(!1),s("Recognizing your voice..."),h.current&&(t(!0),e||h.current.start())},C=()=>{h.current&&(t(!1),h.current.stop(),E())},k=()=>{s(""),console.log("transcript cleared"+n),s("")},E=()=>{let e=(null==y?void 0:y.fingerprintValue.date)?new Date(y.fingerprintValue.date):null;if(n.trim()){let t={text:n,isMe:!0,isInterim:!1};"Recognizing your voice..."!=t.text&&(y.fingerprintValue.values<5||(null==e?void 0:e.getDay())!=D.getDay())?(g(e=>[...e,t]),V(),s("")):(alert("You have reached the maximum amount of requests for today. Please try again tomorrow. Sadly, computational power doesn't grow on trees, yet..."),m(!1))}},V=async()=>{n&&p().then(async e=>{let t=(null==y?void 0:y.fingerprintValue.date)?new Date(null==y?void 0:y.fingerprintValue.date):null;if((null==t?void 0:t.getDay())==D.getDay()){console.log("trying to add date to existing fingerprintValue..."),await w.addDateToFingerprint(e,D,y.fingerprintValue.values+1).then(e=>console.log(e));let t={fingerprint:e,date:D,values:y.fingerprintValue.values+1};b({fingerprintValue:t})}else console.log("trying to add date to fingerprintValue..."),w.addDateToFingerprint(e,D,1).then(e=>console.log(e)),b({fingerprintValue:{fingerprint:e,date:D,values:1}})})};return"undefined"!=typeof navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,(0,r.jsxs)("div",{className:"flex flex-col items-center min-h-screen bg-app-background min-w-200",children:[(0,r.jsx)(c,{children:(0,r.jsx)("div",{className:"mb-5 w-full",children:(0,r.jsx)(d,{messages:u,interimTranscript:n})})}),(0,r.jsx)("div",{className:"text-white flex items-center",children:j||!n?(0,r.jsx)("div",{children:n}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:n}),(0,r.jsxs)("div",{className:"spinner",children:[(0,r.jsx)("div",{className:"double-bounce1"}),(0,r.jsx)("div",{className:"double-bounce2"})]})]})}),(0,r.jsxs)("div",{className:"flex flex-wrap pt-2 justify-between items-center w-full max-w-2xl space-x-4",children:[(0,r.jsx)(a,{onClick:()=>E()}),(0,r.jsx)(l,{isListening:e,onMouseDown:S,onMouseUp:C,voiceValue:v}),(0,r.jsx)("button",{className:"bg-red-500 text-white px-3 py-3 rounded focus:outline-none",onClick:()=>k(),children:"Clear"})]})]})};var w=v}},function(e){e.O(0,[16,777,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);